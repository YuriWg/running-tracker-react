{"ast":null,"code":"var _jsxFileName = \"/Users/wyl/Documents/GitHub/running-tracker-react/src/components/Calendar.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useContext, useState } from 'react';\nimport * as d3 from 'd3';\nimport { AppContext } from '../context/AppContext';\nimport './Calendar.css';\n\n// 导入格式化工具\nimport { formatPace } from '../utils/formatters';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Calendar = () => {\n  _s();\n  const svgRef = useRef(null);\n  const containerRef = useRef(null);\n  const {\n    runData,\n    isLoading\n  } = useContext(AppContext);\n  const [dimensions, setDimensions] = useState({\n    width: 0,\n    height: 0\n  });\n\n  // 添加窗口大小变化监听\n  useEffect(() => {\n    const handleResize = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setDimensions({\n          width: rect.width,\n          height: Math.max(rect.width * 0.9, 400) // 根据宽度调整高度，但保持最小高度\n        });\n      }\n    };\n\n    // 初始调用一次获取当前尺寸\n    handleResize();\n\n    // 监听窗口大小变化\n    window.addEventListener('resize', handleResize);\n\n    // 清除监听器\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // 更新SVG视图\n  useEffect(() => {\n    if (isLoading || !dimensions.width || !svgRef.current || !containerRef.current) return;\n    const svg = d3.select(svgRef.current);\n    svg.selectAll(\"*\").remove();\n    const {\n      width,\n      height\n    } = dimensions;\n\n    // 设置SVG尺寸\n    svg.attr(\"width\", width).attr(\"height\", height).attr(\"viewBox\", `0 0 ${width} ${height}`).attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n\n    // 背景\n    svg.append(\"rect\").attr(\"width\", width).attr(\"height\", height).attr(\"fill\", \"#FDFAF6\").attr(\"rx\", 10);\n\n    // 布局参数 - 使用相对尺寸而非固定尺寸\n    const layout = {\n      leftMargin: width * 0.08,\n      topMargin: 65,\n      rightMargin: width * 0.08,\n      bottomMargin: 30\n    };\n    const usableWidth = width - layout.leftMargin - layout.rightMargin;\n    const monthWidth = usableWidth / 12;\n    // 更改计算方式以确保足够空间\n    const daySpacing = (height - layout.topMargin - layout.bottomMargin) / 32;\n\n    // 月份标签\n    const months = [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"];\n    for (let i = 0; i < 12; i++) {\n      // 月份背景\n      svg.append(\"rect\").attr(\"x\", layout.leftMargin + i * monthWidth + 2).attr(\"y\", 8).attr(\"width\", monthWidth - 4).attr(\"height\", 30).attr(\"fill\", d3.rgb(\"#FDFAF6\").darker(0.05)).attr(\"opacity\", 0.2).attr(\"rx\", 15);\n\n      // 月份文字 - 响应式字体大小\n      svg.append(\"text\").attr(\"x\", layout.leftMargin + i * monthWidth + monthWidth / 2).attr(\"y\", 28).attr(\"text-anchor\", \"middle\").attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n      .attr(\"font-weight\", \"bold\").attr(\"fill\", \"#896B54\").text(months[i]);\n    }\n\n    // 网格线\n    const gridGroup = svg.append(\"g\").attr(\"class\", \"grid\");\n\n    // 垂直网格线（月份分隔线）\n    for (let i = 0; i <= 12; i++) {\n      gridGroup.append(\"line\").attr(\"x1\", layout.leftMargin + i * monthWidth).attr(\"y1\", layout.topMargin).attr(\"x2\", layout.leftMargin + i * monthWidth).attr(\"y2\", height - layout.bottomMargin).style(\"stroke\", i % 3 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.05)\").style(\"stroke-width\", i % 3 === 0 ? 1.5 : 0.5);\n    }\n\n    // 水平网格线和日期标签\n    for (let i = 0; i <= 31; i++) {\n      const yPos = layout.topMargin + i * daySpacing;\n      gridGroup.append(\"line\").attr(\"x1\", layout.leftMargin - 5).attr(\"y1\", yPos).attr(\"x2\", width - layout.rightMargin).attr(\"y2\", yPos).style(\"stroke\", i % 5 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.03)\").style(\"stroke-width\", i % 5 === 0 ? 1.5 : 0.5);\n      if (i > 0 && i % 5 === 0) {\n        gridGroup.append(\"text\").attr(\"x\", layout.leftMargin - 20).attr(\"y\", yPos + 5).attr(\"text-anchor\", \"end\").attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n        .attr(\"fill\", \"#896B54\").text(i);\n      }\n    }\n\n    // 绘制跑步数据点\n    if (runData && runData.length > 0) {\n      runData.forEach(run => {\n        if (typeof run.month !== 'number' || typeof run.day !== 'number') {\n          console.warn(\"跳过无效数据点:\", run);\n          return;\n        }\n\n        // 确保月份和日期在有效范围内\n        if (run.month < 0 || run.month >= 12 || run.day <= 0 || run.day > 31) {\n          console.warn(\"数据点超出有效范围:\", run);\n          return;\n        }\n        const x = layout.leftMargin + run.month * monthWidth + monthWidth / 2;\n        const y = layout.topMargin + run.day * daySpacing;\n\n        // 检查计算的坐标是否有效\n        if (isNaN(x) || isNaN(y)) {\n          console.error(\"坐标计算错误:\", {\n            run,\n            x,\n            y\n          });\n          return;\n        }\n\n        // 计算图标缩放比例 - 根据容器宽度自适应\n        const iconScale = Math.min(1.2, Math.max(0.8, width / 1000));\n        const runGroup = svg.append(\"g\").attr(\"class\", \"run-icon\").attr(\"transform\", `translate(${x}, ${y}) scale(${iconScale})`).attr(\"cursor\", \"pointer\");\n\n        // 绘制跑步图标\n        drawRunIcon(runGroup, run);\n\n        // 添加事件处理\n        runGroup.on(\"mouseover\", function (event) {\n          // 显示提示框\n          const tooltip = d3.select(\".tooltip\");\n          if (tooltip.empty()) {\n            d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"background\", \"white\").style(\"padding\", \"15px\").style(\"border-radius\", \"8px\").style(\"box-shadow\", \"0 4px 20px rgba(0,0,0,0.08)\").style(\"z-index\", \"999\").style(\"max-width\", \"280px\");\n          }\n\n          // 位置和内容\n          const containerRect = containerRef.current.getBoundingClientRect();\n          const tooltipContent = `\n            <div style=\"font-weight:600; color:#432818; font-size:14px; margin-bottom:8px;\">\n              ${run.title || `${run.year}-${(run.month + 1).toString().padStart(2, '0')}-${run.day.toString().padStart(2, '0')}`}\n            </div>\n            <div>距离: ${run.distance.toFixed(1)} km</div>\n            <div>配速: ${formatPace(run.pace)}/km</div>\n            ${run.heartRate ? `<div>心率: ${run.heartRate} BPM</div>` : ''}\n            ${run.runningNote ? `<div style=\"margin-top:6px; font-style:italic;\">${run.runningNote}</div>` : ''}\n          `;\n          d3.select(\".tooltip\").html(tooltipContent).style(\"left\", `${event.pageX + 15}px`).style(\"top\", `${event.pageY - 15}px`).style(\"visibility\", \"visible\");\n        }).on(\"mouseout\", function () {\n          d3.select(\".tooltip\").style(\"visibility\", \"hidden\");\n        });\n      });\n    }\n  }, [runData, isLoading, dimensions]);\n\n  // 绘制跑步图标函数\n  const drawRunIcon = (container, data) => {\n    // 螺旋线参数\n    const turns = 2 + Math.min(3, data.distance / 5);\n    const spacing = 3.5;\n    const baseRadius = 3.5;\n\n    // 颜色选择\n    let spiralColor;\n    if (data.distance >= 10) spiralColor = \"#FF9966\"; // 长距离\n    else if (data.distance > 5) spiralColor = \"#FFD700\"; // 中距离\n    else spiralColor = \"#87CEEB\"; // 短距离\n\n    // 创建渐变\n    const gradientId = `spiral-gradient-${Math.random().toString(36).substring(2, 11)}`;\n    const defs = container.append(\"defs\");\n    const gradient = defs.append(\"radialGradient\").attr(\"id\", gradientId).attr(\"cx\", \"0\").attr(\"cy\", \"0\").attr(\"r\", \"100%\").attr(\"fx\", \"0\").attr(\"fy\", \"0\").attr(\"gradientUnits\", \"userSpaceOnUse\");\n    gradient.append(\"stop\").attr(\"offset\", \"0%\").attr(\"stop-color\", spiralColor).attr(\"stop-opacity\", 0.9);\n    gradient.append(\"stop\").attr(\"offset\", \"100%\").attr(\"stop-color\", spiralColor).attr(\"stop-opacity\", 0.5);\n\n    // 最大角度\n    const maxAngle = turns * 2 * Math.PI;\n    const angleStep = 0.1;\n\n    // 创建螺旋线生成器\n    const spiral = d3.lineRadial().angle(d => d).radius(d => baseRadius + spacing * d / (2 * Math.PI));\n\n    // 创建一个包含所有螺旋线元素的组\n    const spiralGroup = container.append(\"g\").attr(\"class\", \"spiral-group\");\n\n    // 静态完整螺旋线\n    const points = d3.range(0, maxAngle, angleStep);\n    const staticSpiral = spiralGroup.append(\"path\").datum(points).attr(\"d\", spiral).attr(\"fill\", \"none\").attr(\"stroke\", `url(#${gradientId})`).attr(\"stroke-width\", 2.5).attr(\"stroke-linecap\", \"round\");\n\n    // 动画用路径（初始不可见）\n    const animSpiral = spiralGroup.append(\"path\").attr(\"fill\", \"none\").attr(\"stroke\", `url(#${gradientId})`).attr(\"stroke-width\", 2.5).attr(\"stroke-linecap\", \"round\").style(\"opacity\", 0);\n\n    // 配速指示器\n    let paceCircle = null;\n    if (data.pace > 0) {\n      const spiralMaxRadius = baseRadius + spacing * maxAngle / (2 * Math.PI);\n      const circleRadius = 3.6;\n      const distanceFactor = 1.3;\n      const circleX = spiralMaxRadius * distanceFactor * (1 / Math.sqrt(2));\n      const circleY = -spiralMaxRadius * distanceFactor * (1 / Math.sqrt(2));\n\n      // 根据配速选择颜色\n      let paceColor;\n      if (data.pace < 5.5) paceColor = \"#FF4500\"; // 快配速\n      else if (data.pace < 7) paceColor = \"#FFD700\"; // 中配速\n      else paceColor = \"#7FD8BE\"; // 慢配速\n\n      // 添加配速指示圆点\n      paceCircle = container.append(\"circle\").attr(\"cx\", circleX).attr(\"cy\", circleY).attr(\"r\", circleRadius).attr(\"fill\", paceColor).attr(\"stroke\", \"#fff\").attr(\"stroke-width\", 1).style(\"opacity\", 0.9);\n    }\n\n    // 动画状态变量 - 设为容器的属性以增加可访问性\n    container._isAnimating = false;\n    container._animationTimer = null;\n    container._hoverState = false; // 新增：跟踪鼠标是否在图标上\n\n    // 创建透明的较大热区，增加鼠标事件的稳定性\n    const hitArea = container.append(\"circle\").attr(\"cx\", 0).attr(\"cy\", 0).attr(\"r\", 15) // 较大的半径提供更好的交互区域\n    .attr(\"fill\", \"transparent\").style(\"pointer-events\", \"all\"); // 确保能捕获事件\n\n    // 动画函数 - 提取出来以便复用\n    function startAnimation() {\n      // 如果已经在动画中，不再重复启动\n      if (container._isAnimating) return;\n      container._isAnimating = true;\n      container._hoverState = true;\n\n      // 清除任何存在的定时器\n      if (container._animationTimer) {\n        clearTimeout(container._animationTimer);\n        container._animationTimer = null;\n      }\n\n      // 隐藏静态螺旋线\n      staticSpiral.transition().duration(100).style(\"opacity\", 0);\n\n      // 暂时隐藏配速指示器\n      if (paceCircle) paceCircle.transition().duration(100).style(\"opacity\", 0);\n\n      // 创建动态增长的螺旋线动画\n      const numSteps = 20; // 动画步数\n      let currentStep = 0;\n      function animateSpiral() {\n        if (!container._hoverState || currentStep >= numSteps) {\n          // 动画完成或鼠标已离开，显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n          container._animationTimer = null;\n          return;\n        }\n\n        // 增加当前步骤\n        currentStep++;\n\n        // 计算此步骤的螺旋线角度\n        const currentAngle = currentStep / numSteps * maxAngle;\n        const currentPoints = d3.range(0, currentAngle, angleStep);\n\n        // 更新动画螺旋线\n        animSpiral.datum(currentPoints).attr(\"d\", spiral).style(\"opacity\", 1);\n\n        // 设置下一帧\n        container._animationTimer = setTimeout(animateSpiral, 20);\n      }\n\n      // 启动动画\n      animateSpiral();\n    }\n\n    // 结束动画函数\n    function endAnimation() {\n      container._hoverState = false; // 标记鼠标已离开\n\n      // 添加延迟以避免鼠标短暂离开又返回时动画重启\n      setTimeout(() => {\n        if (!container._hoverState) {\n          // 如果鼠标真的离开了(没有重新进入)\n          if (container._animationTimer) {\n            clearTimeout(container._animationTimer);\n            container._animationTimer = null;\n          }\n\n          // 立即显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n        }\n      }, 50); // 短暂延迟，避免鼠标在图标边缘快速移动时动画闪烁\n    }\n\n    // 使用容器和热区同时监听事件，增加稳定性\n    container.on(\"mouseenter.animation\", startAnimation);\n    container.on(\"mouseleave.animation\", endAnimation);\n    hitArea.on(\"mouseenter.animation\", startAnimation);\n    hitArea.on(\"mouseleave.animation\", endAnimation);\n\n    // 防止事件传播导致问题\n    container.on(\"mousemove\", function (event) {\n      event.stopPropagation();\n      if (!container._isAnimating && container._hoverState) {\n        // 如果鼠标在图标上但动画停止了，重新启动\n        startAnimation();\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    className: \"calendar-container\",\n    children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"calendar-loading\",\n      children: \"\\u52A0\\u8F7D\\u4E2D...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: svgRef,\n      xmlns: \"http://www.w3.org/2000/svg\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 408,\n    columnNumber: 5\n  }, this);\n};\n_s(Calendar, \"Ni5LZYdkHalupm/d5SDu0jTURs4=\");\n_c = Calendar;\nexport default Calendar;\nvar _c;\n$RefreshReg$(_c, \"Calendar\");","map":{"version":3,"names":["React","useRef","useEffect","useContext","useState","d3","AppContext","formatPace","jsxDEV","_jsxDEV","Calendar","_s","svgRef","containerRef","runData","isLoading","dimensions","setDimensions","width","height","handleResize","current","rect","getBoundingClientRect","Math","max","window","addEventListener","removeEventListener","svg","select","selectAll","remove","attr","append","layout","leftMargin","topMargin","rightMargin","bottomMargin","usableWidth","monthWidth","daySpacing","months","i","rgb","darker","min","text","gridGroup","style","yPos","length","forEach","run","month","day","console","warn","x","y","isNaN","error","iconScale","runGroup","drawRunIcon","on","event","tooltip","empty","containerRect","tooltipContent","title","year","toString","padStart","distance","toFixed","pace","heartRate","runningNote","html","pageX","pageY","container","data","turns","spacing","baseRadius","spiralColor","gradientId","random","substring","defs","gradient","maxAngle","PI","angleStep","spiral","lineRadial","angle","d","radius","spiralGroup","points","range","staticSpiral","datum","animSpiral","paceCircle","spiralMaxRadius","circleRadius","distanceFactor","circleX","sqrt","circleY","paceColor","_isAnimating","_animationTimer","_hoverState","hitArea","startAnimation","clearTimeout","transition","duration","numSteps","currentStep","animateSpiral","interrupt","currentAngle","currentPoints","setTimeout","endAnimation","stopPropagation","ref","className","children","fileName","_jsxFileName","lineNumber","columnNumber","xmlns","_c","$RefreshReg$"],"sources":["/Users/wyl/Documents/GitHub/running-tracker-react/src/components/Calendar.js"],"sourcesContent":["import React, { useRef, useEffect, useContext, useState } from 'react';\nimport * as d3 from 'd3';\nimport { AppContext } from '../context/AppContext';\nimport './Calendar.css';\n\n// 导入格式化工具\nimport { formatPace } from '../utils/formatters';\n\nconst Calendar = () => {\n  const svgRef = useRef(null);\n  const containerRef = useRef(null);\n  const { runData, isLoading } = useContext(AppContext);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  \n  // 添加窗口大小变化监听\n  useEffect(() => {\n    const handleResize = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setDimensions({\n          width: rect.width,\n          height: Math.max(rect.width * 0.9, 400) // 根据宽度调整高度，但保持最小高度\n        });\n      }\n    };\n    \n    // 初始调用一次获取当前尺寸\n    handleResize();\n    \n    // 监听窗口大小变化\n    window.addEventListener('resize', handleResize);\n    \n    // 清除监听器\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  \n  // 更新SVG视图\n  useEffect(() => {\n    if (isLoading || !dimensions.width || !svgRef.current || !containerRef.current) return;\n    \n    const svg = d3.select(svgRef.current);\n    svg.selectAll(\"*\").remove();\n    \n    const { width, height } = dimensions;\n    \n    // 设置SVG尺寸\n    svg.attr(\"width\", width)\n       .attr(\"height\", height)\n       .attr(\"viewBox\", `0 0 ${width} ${height}`)\n       .attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n    \n    // 背景\n    svg.append(\"rect\")\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .attr(\"fill\", \"#FDFAF6\")\n      .attr(\"rx\", 10);\n    \n    // 布局参数 - 使用相对尺寸而非固定尺寸\n    const layout = {\n      leftMargin: width * 0.08,\n      topMargin: 65,\n      rightMargin: width * 0.08,\n      bottomMargin: 30\n    };\n    \n    const usableWidth = width - layout.leftMargin - layout.rightMargin;\n    const monthWidth = usableWidth / 12;\n    // 更改计算方式以确保足够空间\n    const daySpacing = (height - layout.topMargin - layout.bottomMargin) / 32;\n    \n    // 月份标签\n    const months = [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"];\n    for (let i = 0; i < 12; i++) {\n      // 月份背景\n      svg.append(\"rect\")\n        .attr(\"x\", layout.leftMargin + i * monthWidth + 2)\n        .attr(\"y\", 8)\n        .attr(\"width\", monthWidth - 4)\n        .attr(\"height\", 30)\n        .attr(\"fill\", d3.rgb(\"#FDFAF6\").darker(0.05))\n        .attr(\"opacity\", 0.2)\n        .attr(\"rx\", 15);\n        \n      // 月份文字 - 响应式字体大小\n      svg.append(\"text\")\n        .attr(\"x\", layout.leftMargin + i * monthWidth + monthWidth / 2)\n        .attr(\"y\", 28)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n        .attr(\"font-weight\", \"bold\")\n        .attr(\"fill\", \"#896B54\")\n        .text(months[i]);\n    }\n    \n    // 网格线\n    const gridGroup = svg.append(\"g\").attr(\"class\", \"grid\");\n    \n    // 垂直网格线（月份分隔线）\n    for (let i = 0; i <= 12; i++) {\n      gridGroup.append(\"line\")\n        .attr(\"x1\", layout.leftMargin + i * monthWidth)\n        .attr(\"y1\", layout.topMargin)\n        .attr(\"x2\", layout.leftMargin + i * monthWidth)\n        .attr(\"y2\", height - layout.bottomMargin)\n        .style(\"stroke\", i % 3 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.05)\")\n        .style(\"stroke-width\", i % 3 === 0 ? 1.5 : 0.5);\n    }\n    \n    // 水平网格线和日期标签\n    for (let i = 0; i <= 31; i++) {\n      const yPos = layout.topMargin + i * daySpacing;\n      \n      gridGroup.append(\"line\")\n        .attr(\"x1\", layout.leftMargin - 5)\n        .attr(\"y1\", yPos)\n        .attr(\"x2\", width - layout.rightMargin)\n        .attr(\"y2\", yPos)\n        .style(\"stroke\", i % 5 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.03)\")\n        .style(\"stroke-width\", i % 5 === 0 ? 1.5 : 0.5);\n      \n      if (i > 0 && i % 5 === 0) {\n        gridGroup.append(\"text\")\n          .attr(\"x\", layout.leftMargin - 20)\n          .attr(\"y\", yPos + 5)\n          .attr(\"text-anchor\", \"end\")\n          .attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n          .attr(\"fill\", \"#896B54\")\n          .text(i);\n      }\n    }\n    \n    // 绘制跑步数据点\n    if (runData && runData.length > 0) {\n      runData.forEach(run => {\n        if (typeof run.month !== 'number' || typeof run.day !== 'number') {\n          console.warn(\"跳过无效数据点:\", run);\n          return;\n        }\n        \n        // 确保月份和日期在有效范围内\n        if (run.month < 0 || run.month >= 12 || run.day <= 0 || run.day > 31) {\n          console.warn(\"数据点超出有效范围:\", run);\n          return;\n        }\n        \n        const x = layout.leftMargin + run.month * monthWidth + monthWidth / 2;\n        const y = layout.topMargin + run.day * daySpacing;\n        \n        // 检查计算的坐标是否有效\n        if (isNaN(x) || isNaN(y)) {\n          console.error(\"坐标计算错误:\", { run, x, y });\n          return;\n        }\n        \n        // 计算图标缩放比例 - 根据容器宽度自适应\n        const iconScale = Math.min(1.2, Math.max(0.8, width / 1000));\n        \n        const runGroup = svg.append(\"g\")\n          .attr(\"class\", \"run-icon\")\n          .attr(\"transform\", `translate(${x}, ${y}) scale(${iconScale})`)\n          .attr(\"cursor\", \"pointer\");\n        \n        // 绘制跑步图标\n        drawRunIcon(runGroup, run);\n        \n        // 添加事件处理\n        runGroup.on(\"mouseover\", function(event) {\n          // 显示提示框\n          const tooltip = d3.select(\".tooltip\");\n          if (tooltip.empty()) {\n            d3.select(\"body\").append(\"div\")\n              .attr(\"class\", \"tooltip\")\n              .style(\"position\", \"absolute\")\n              .style(\"visibility\", \"hidden\")\n              .style(\"background\", \"white\")\n              .style(\"padding\", \"15px\")\n              .style(\"border-radius\", \"8px\")\n              .style(\"box-shadow\", \"0 4px 20px rgba(0,0,0,0.08)\")\n              .style(\"z-index\", \"999\")\n              .style(\"max-width\", \"280px\");\n          }\n          \n          // 位置和内容\n          const containerRect = containerRef.current.getBoundingClientRect();\n          const tooltipContent = `\n            <div style=\"font-weight:600; color:#432818; font-size:14px; margin-bottom:8px;\">\n              ${run.title || `${run.year}-${(run.month+1).toString().padStart(2,'0')}-${run.day.toString().padStart(2,'0')}`}\n            </div>\n            <div>距离: ${run.distance.toFixed(1)} km</div>\n            <div>配速: ${formatPace(run.pace)}/km</div>\n            ${run.heartRate ? `<div>心率: ${run.heartRate} BPM</div>` : ''}\n            ${run.runningNote ? `<div style=\"margin-top:6px; font-style:italic;\">${run.runningNote}</div>` : ''}\n          `;\n          \n          d3.select(\".tooltip\")\n            .html(tooltipContent)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 15}px`)\n            .style(\"visibility\", \"visible\");\n        })\n        .on(\"mouseout\", function() {\n          d3.select(\".tooltip\").style(\"visibility\", \"hidden\");\n        });\n      });\n    }\n  }, [runData, isLoading, dimensions]);\n  \n  // 绘制跑步图标函数\n  const drawRunIcon = (container, data) => {\n    // 螺旋线参数\n    const turns = 2 + Math.min(3, data.distance / 5);\n    const spacing = 3.5;\n    const baseRadius = 3.5;\n    \n    // 颜色选择\n    let spiralColor;\n    if (data.distance >= 10) spiralColor = \"#FF9966\"; // 长距离\n    else if (data.distance > 5) spiralColor = \"#FFD700\"; // 中距离\n    else spiralColor = \"#87CEEB\"; // 短距离\n    \n    // 创建渐变\n    const gradientId = `spiral-gradient-${Math.random().toString(36).substring(2, 11)}`;\n    const defs = container.append(\"defs\");\n    const gradient = defs.append(\"radialGradient\")\n      .attr(\"id\", gradientId)\n      .attr(\"cx\", \"0\")\n      .attr(\"cy\", \"0\")\n      .attr(\"r\", \"100%\")\n      .attr(\"fx\", \"0\")\n      .attr(\"fy\", \"0\")\n      .attr(\"gradientUnits\", \"userSpaceOnUse\");\n    \n    gradient.append(\"stop\")\n      .attr(\"offset\", \"0%\")\n      .attr(\"stop-color\", spiralColor)\n      .attr(\"stop-opacity\", 0.9);\n    \n    gradient.append(\"stop\")\n      .attr(\"offset\", \"100%\")\n      .attr(\"stop-color\", spiralColor)\n      .attr(\"stop-opacity\", 0.5);\n    \n    // 最大角度\n    const maxAngle = turns * 2 * Math.PI;\n    const angleStep = 0.1;\n    \n    // 创建螺旋线生成器\n    const spiral = d3.lineRadial()\n      .angle(d => d)\n      .radius(d => baseRadius + spacing * d / (2 * Math.PI));\n    \n    // 创建一个包含所有螺旋线元素的组\n    const spiralGroup = container.append(\"g\")\n      .attr(\"class\", \"spiral-group\");\n      \n    // 静态完整螺旋线\n    const points = d3.range(0, maxAngle, angleStep);\n    const staticSpiral = spiralGroup.append(\"path\")\n      .datum(points)\n      .attr(\"d\", spiral)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", `url(#${gradientId})`)\n      .attr(\"stroke-width\", 2.5)\n      .attr(\"stroke-linecap\", \"round\");\n      \n    // 动画用路径（初始不可见）\n    const animSpiral = spiralGroup.append(\"path\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", `url(#${gradientId})`)\n      .attr(\"stroke-width\", 2.5)\n      .attr(\"stroke-linecap\", \"round\")\n      .style(\"opacity\", 0);\n    \n    // 配速指示器\n    let paceCircle = null;\n    if (data.pace > 0) {\n      const spiralMaxRadius = baseRadius + spacing * maxAngle / (2 * Math.PI);\n      const circleRadius = 3.6;\n      const distanceFactor = 1.3;\n      const circleX = spiralMaxRadius * distanceFactor * (1/Math.sqrt(2));\n      const circleY = -spiralMaxRadius * distanceFactor * (1/Math.sqrt(2));\n      \n      // 根据配速选择颜色\n      let paceColor;\n      if (data.pace < 5.5) paceColor = \"#FF4500\"; // 快配速\n      else if (data.pace < 7) paceColor = \"#FFD700\"; // 中配速\n      else paceColor = \"#7FD8BE\"; // 慢配速\n      \n      // 添加配速指示圆点\n      paceCircle = container.append(\"circle\")\n        .attr(\"cx\", circleX)\n        .attr(\"cy\", circleY)\n        .attr(\"r\", circleRadius)\n        .attr(\"fill\", paceColor)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"stroke-width\", 1)\n        .style(\"opacity\", 0.9);\n    }\n    \n    // 动画状态变量 - 设为容器的属性以增加可访问性\n    container._isAnimating = false;\n    container._animationTimer = null;\n    container._hoverState = false; // 新增：跟踪鼠标是否在图标上\n    \n    // 创建透明的较大热区，增加鼠标事件的稳定性\n    const hitArea = container.append(\"circle\")\n      .attr(\"cx\", 0)\n      .attr(\"cy\", 0)\n      .attr(\"r\", 15) // 较大的半径提供更好的交互区域\n      .attr(\"fill\", \"transparent\")\n      .style(\"pointer-events\", \"all\"); // 确保能捕获事件\n    \n    // 动画函数 - 提取出来以便复用\n    function startAnimation() {\n      // 如果已经在动画中，不再重复启动\n      if (container._isAnimating) return;\n      container._isAnimating = true;\n      container._hoverState = true;\n      \n      // 清除任何存在的定时器\n      if (container._animationTimer) {\n        clearTimeout(container._animationTimer);\n        container._animationTimer = null;\n      }\n      \n      // 隐藏静态螺旋线\n      staticSpiral.transition().duration(100).style(\"opacity\", 0);\n      \n      // 暂时隐藏配速指示器\n      if (paceCircle) paceCircle.transition().duration(100).style(\"opacity\", 0);\n      \n      // 创建动态增长的螺旋线动画\n      const numSteps = 20; // 动画步数\n      let currentStep = 0;\n      \n      function animateSpiral() {\n        if (!container._hoverState || currentStep >= numSteps) {\n          // 动画完成或鼠标已离开，显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n          container._animationTimer = null;\n          return;\n        }\n        \n        // 增加当前步骤\n        currentStep++;\n        \n        // 计算此步骤的螺旋线角度\n        const currentAngle = (currentStep / numSteps) * maxAngle;\n        const currentPoints = d3.range(0, currentAngle, angleStep);\n        \n        // 更新动画螺旋线\n        animSpiral\n          .datum(currentPoints)\n          .attr(\"d\", spiral)\n          .style(\"opacity\", 1);\n        \n        // 设置下一帧\n        container._animationTimer = setTimeout(animateSpiral, 20);\n      }\n      \n      // 启动动画\n      animateSpiral();\n    }\n    \n    // 结束动画函数\n    function endAnimation() {\n      container._hoverState = false; // 标记鼠标已离开\n      \n      // 添加延迟以避免鼠标短暂离开又返回时动画重启\n      setTimeout(() => {\n        if (!container._hoverState) {\n          // 如果鼠标真的离开了(没有重新进入)\n          if (container._animationTimer) {\n            clearTimeout(container._animationTimer);\n            container._animationTimer = null;\n          }\n          \n          // 立即显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n        }\n      }, 50); // 短暂延迟，避免鼠标在图标边缘快速移动时动画闪烁\n    }\n    \n    // 使用容器和热区同时监听事件，增加稳定性\n    container.on(\"mouseenter.animation\", startAnimation);\n    container.on(\"mouseleave.animation\", endAnimation);\n    hitArea.on(\"mouseenter.animation\", startAnimation);\n    hitArea.on(\"mouseleave.animation\", endAnimation);\n    \n    // 防止事件传播导致问题\n    container.on(\"mousemove\", function(event) {\n      event.stopPropagation();\n      if (!container._isAnimating && container._hoverState) {\n        // 如果鼠标在图标上但动画停止了，重新启动\n        startAnimation();\n      }\n    });\n  };\n\n  return (\n    <div ref={containerRef} className=\"calendar-container\">\n      {isLoading ? (\n        <div className=\"calendar-loading\">加载中...</div>\n      ) : (\n        <svg ref={svgRef} xmlns=\"http://www.w3.org/2000/svg\"></svg>\n      )}\n    </div>\n  );\n};\n\nexport default Calendar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}