{"ast":null,"code":"import React,{useRef,useEffect,useContext,useState}from'react';import*as d3 from'd3';import{AppContext}from'../context/AppContext';import'./Calendar.css';// 导入格式化工具\nimport{formatPace}from'../utils/formatters';import{jsx as _jsx}from\"react/jsx-runtime\";const Calendar=()=>{const svgRef=useRef(null);const containerRef=useRef(null);const{runData,isLoading}=useContext(AppContext);const[dimensions,setDimensions]=useState({width:0,height:0});// 添加窗口大小变化监听\nuseEffect(()=>{const handleResize=()=>{if(containerRef.current){const rect=containerRef.current.getBoundingClientRect();setDimensions({width:rect.width,height:Math.max(rect.width*0.9,400)// 根据宽度调整高度，但保持最小高度\n});}};// 初始调用一次获取当前尺寸\nhandleResize();// 监听窗口大小变化\nwindow.addEventListener('resize',handleResize);// 清除监听器\nreturn()=>window.removeEventListener('resize',handleResize);},[]);// 更新SVG视图\nuseEffect(()=>{if(isLoading||!dimensions.width||!svgRef.current||!containerRef.current)return;const svg=d3.select(svgRef.current);svg.selectAll(\"*\").remove();const{width,height}=dimensions;// 设置SVG尺寸\nsvg.attr(\"width\",width).attr(\"height\",height).attr(\"viewBox\",`0 0 ${width} ${height}`).attr(\"preserveAspectRatio\",\"xMidYMid meet\");// 背景\nsvg.append(\"rect\").attr(\"width\",width).attr(\"height\",height).attr(\"fill\",\"#FDFAF6\").attr(\"rx\",10);// 布局参数 - 使用相对尺寸而非固定尺寸\nconst layout={leftMargin:width*0.08,topMargin:65,rightMargin:width*0.08,bottomMargin:30};const usableWidth=width-layout.leftMargin-layout.rightMargin;const monthWidth=usableWidth/12;// 更改计算方式以确保足够空间\nconst daySpacing=(height-layout.topMargin-layout.bottomMargin)/32;// 月份标签\nconst months=[\"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\"];for(let i=0;i<12;i++){// 月份背景\nsvg.append(\"rect\").attr(\"x\",layout.leftMargin+i*monthWidth+2).attr(\"y\",8).attr(\"width\",monthWidth-4).attr(\"height\",30).attr(\"fill\",d3.rgb(\"#FDFAF6\").darker(0.05)).attr(\"opacity\",0.2).attr(\"rx\",15);// 月份文字 - 响应式字体大小\nsvg.append(\"text\").attr(\"x\",layout.leftMargin+i*monthWidth+monthWidth/2).attr(\"y\",28).attr(\"text-anchor\",\"middle\").attr(\"font-size\",Math.min(18,Math.max(12,width/50)))// 响应式字体大小\n.attr(\"font-weight\",\"bold\").attr(\"fill\",\"#896B54\").text(months[i]);}// 网格线\nconst gridGroup=svg.append(\"g\").attr(\"class\",\"grid\");// 垂直网格线（月份分隔线）\nfor(let i=0;i<=12;i++){gridGroup.append(\"line\").attr(\"x1\",layout.leftMargin+i*monthWidth).attr(\"y1\",layout.topMargin).attr(\"x2\",layout.leftMargin+i*monthWidth).attr(\"y2\",height-layout.bottomMargin).style(\"stroke\",i%3===0?\"rgba(0,0,0,0.1)\":\"rgba(0,0,0,0.05)\").style(\"stroke-width\",i%3===0?1.5:0.5);}// 水平网格线和日期标签\nfor(let i=0;i<=31;i++){const yPos=layout.topMargin+i*daySpacing;gridGroup.append(\"line\").attr(\"x1\",layout.leftMargin-5).attr(\"y1\",yPos).attr(\"x2\",width-layout.rightMargin).attr(\"y2\",yPos).style(\"stroke\",i%5===0?\"rgba(0,0,0,0.1)\":\"rgba(0,0,0,0.03)\").style(\"stroke-width\",i%5===0?1.5:0.5);if(i>0&&i%5===0){gridGroup.append(\"text\").attr(\"x\",layout.leftMargin-20).attr(\"y\",yPos+5).attr(\"text-anchor\",\"end\").attr(\"font-size\",Math.min(18,Math.max(12,width/50)))// 响应式字体大小\n.attr(\"fill\",\"#896B54\").text(i);}}// 绘制跑步数据点\nif(runData&&runData.length>0){runData.forEach(run=>{if(typeof run.month!=='number'||typeof run.day!=='number'){console.warn(\"跳过无效数据点:\",run);return;}// 确保月份和日期在有效范围内\nif(run.month<0||run.month>=12||run.day<=0||run.day>31){console.warn(\"数据点超出有效范围:\",run);return;}const x=layout.leftMargin+run.month*monthWidth+monthWidth/2;const y=layout.topMargin+run.day*daySpacing;// 检查计算的坐标是否有效\nif(isNaN(x)||isNaN(y)){console.error(\"坐标计算错误:\",{run,x,y});return;}// 计算图标缩放比例 - 根据容器宽度自适应\nconst iconScale=Math.min(1.2,Math.max(0.8,width/1000));const runGroup=svg.append(\"g\").attr(\"class\",\"run-icon\").attr(\"transform\",`translate(${x}, ${y}) scale(${iconScale})`).attr(\"cursor\",\"pointer\");// 绘制跑步图标\ndrawRunIcon(runGroup,run);// 添加事件处理\nrunGroup.on(\"mouseover\",function(event){// 显示提示框\nconst tooltip=d3.select(\".tooltip\");if(tooltip.empty()){d3.select(\"body\").append(\"div\").attr(\"class\",\"tooltip\").style(\"position\",\"absolute\").style(\"visibility\",\"hidden\").style(\"background\",\"white\").style(\"padding\",\"15px\").style(\"border-radius\",\"8px\").style(\"box-shadow\",\"0 4px 20px rgba(0,0,0,0.08)\").style(\"z-index\",\"999\").style(\"max-width\",\"280px\");}// 位置和内容\nconst containerRect=containerRef.current.getBoundingClientRect();const tooltipContent=`\n            <div style=\"font-weight:600; color:#432818; font-size:14px; margin-bottom:8px;\">\n              ${run.title||`${run.year}-${(run.month+1).toString().padStart(2,'0')}-${run.day.toString().padStart(2,'0')}`}\n            </div>\n            <div>距离: ${run.distance.toFixed(1)} km</div>\n            <div>配速: ${formatPace(run.pace)}/km</div>\n            ${run.heartRate?`<div>心率: ${run.heartRate} BPM</div>`:''}\n            ${run.runningNote?`<div style=\"margin-top:6px; font-style:italic;\">${run.runningNote}</div>`:''}\n          `;d3.select(\".tooltip\").html(tooltipContent).style(\"left\",`${event.pageX+15}px`).style(\"top\",`${event.pageY-15}px`).style(\"visibility\",\"visible\");}).on(\"mouseout\",function(){d3.select(\".tooltip\").style(\"visibility\",\"hidden\");});});}},[runData,isLoading,dimensions]);// 绘制跑步图标函数\nconst drawRunIcon=(container,data)=>{// 螺旋线参数\nconst turns=2+Math.min(3,data.distance/5);const spacing=3.5;const baseRadius=3.5;// 颜色选择\nlet spiralColor;if(data.distance>=10)spiralColor=\"#FF9966\";// 长距离\nelse if(data.distance>5)spiralColor=\"#FFD700\";// 中距离\nelse spiralColor=\"#87CEEB\";// 短距离\n// 创建渐变\nconst gradientId=`spiral-gradient-${Math.random().toString(36).substring(2,11)}`;const defs=container.append(\"defs\");const gradient=defs.append(\"radialGradient\").attr(\"id\",gradientId).attr(\"cx\",\"0\").attr(\"cy\",\"0\").attr(\"r\",\"100%\").attr(\"fx\",\"0\").attr(\"fy\",\"0\").attr(\"gradientUnits\",\"userSpaceOnUse\");gradient.append(\"stop\").attr(\"offset\",\"0%\").attr(\"stop-color\",spiralColor).attr(\"stop-opacity\",0.9);gradient.append(\"stop\").attr(\"offset\",\"100%\").attr(\"stop-color\",spiralColor).attr(\"stop-opacity\",0.5);// 最大角度\nconst maxAngle=turns*2*Math.PI;const angleStep=0.1;// 创建螺旋线生成器\nconst spiral=d3.lineRadial().angle(d=>d).radius(d=>baseRadius+spacing*d/(2*Math.PI));// 创建一个包含所有螺旋线元素的组\nconst spiralGroup=container.append(\"g\").attr(\"class\",\"spiral-group\");// 静态完整螺旋线\nconst points=d3.range(0,maxAngle,angleStep);const staticSpiral=spiralGroup.append(\"path\").datum(points).attr(\"d\",spiral).attr(\"fill\",\"none\").attr(\"stroke\",`url(#${gradientId})`).attr(\"stroke-width\",2.5).attr(\"stroke-linecap\",\"round\");// 动画用路径（初始不可见）\nconst animSpiral=spiralGroup.append(\"path\").attr(\"fill\",\"none\").attr(\"stroke\",`url(#${gradientId})`).attr(\"stroke-width\",2.5).attr(\"stroke-linecap\",\"round\").style(\"opacity\",0);// 配速指示器\nlet paceCircle=null;if(data.pace>0){const spiralMaxRadius=baseRadius+spacing*maxAngle/(2*Math.PI);const circleRadius=3.6;const distanceFactor=1.3;const circleX=spiralMaxRadius*distanceFactor*(1/Math.sqrt(2));const circleY=-spiralMaxRadius*distanceFactor*(1/Math.sqrt(2));// 根据配速选择颜色\nlet paceColor;if(data.pace<5.5)paceColor=\"#FF4500\";// 快配速\nelse if(data.pace<7)paceColor=\"#FFD700\";// 中配速\nelse paceColor=\"#7FD8BE\";// 慢配速\n// 添加配速指示圆点\npaceCircle=container.append(\"circle\").attr(\"cx\",circleX).attr(\"cy\",circleY).attr(\"r\",circleRadius).attr(\"fill\",paceColor).attr(\"stroke\",\"#fff\").attr(\"stroke-width\",1).style(\"opacity\",0.9);}// 动画状态变量 - 设为容器的属性以增加可访问性\ncontainer._isAnimating=false;container._animationTimer=null;container._hoverState=false;// 新增：跟踪鼠标是否在图标上\n// 创建透明的较大热区，增加鼠标事件的稳定性\nconst hitArea=container.append(\"circle\").attr(\"cx\",0).attr(\"cy\",0).attr(\"r\",15)// 较大的半径提供更好的交互区域\n.attr(\"fill\",\"transparent\").style(\"pointer-events\",\"all\");// 确保能捕获事件\n// 动画函数 - 提取出来以便复用\nfunction startAnimation(){// 如果已经在动画中，不再重复启动\nif(container._isAnimating)return;container._isAnimating=true;container._hoverState=true;// 清除任何存在的定时器\nif(container._animationTimer){clearTimeout(container._animationTimer);container._animationTimer=null;}// 隐藏静态螺旋线\nstaticSpiral.transition().duration(100).style(\"opacity\",0);// 暂时隐藏配速指示器\nif(paceCircle)paceCircle.transition().duration(100).style(\"opacity\",0);// 创建动态增长的螺旋线动画\nconst numSteps=20;// 动画步数\nlet currentStep=0;function animateSpiral(){if(!container._hoverState||currentStep>=numSteps){// 动画完成或鼠标已离开，显示静态螺旋线\nstaticSpiral.interrupt().style(\"opacity\",1);animSpiral.interrupt().style(\"opacity\",0);if(paceCircle)paceCircle.interrupt().style(\"opacity\",0.9);container._isAnimating=false;container._animationTimer=null;return;}// 增加当前步骤\ncurrentStep++;// 计算此步骤的螺旋线角度\nconst currentAngle=currentStep/numSteps*maxAngle;const currentPoints=d3.range(0,currentAngle,angleStep);// 更新动画螺旋线\nanimSpiral.datum(currentPoints).attr(\"d\",spiral).style(\"opacity\",1);// 设置下一帧\ncontainer._animationTimer=setTimeout(animateSpiral,20);}// 启动动画\nanimateSpiral();}// 结束动画函数\nfunction endAnimation(){container._hoverState=false;// 标记鼠标已离开\n// 添加延迟以避免鼠标短暂离开又返回时动画重启\nsetTimeout(()=>{if(!container._hoverState){// 如果鼠标真的离开了(没有重新进入)\nif(container._animationTimer){clearTimeout(container._animationTimer);container._animationTimer=null;}// 立即显示静态螺旋线\nstaticSpiral.interrupt().style(\"opacity\",1);animSpiral.interrupt().style(\"opacity\",0);if(paceCircle)paceCircle.interrupt().style(\"opacity\",0.9);container._isAnimating=false;}},50);// 短暂延迟，避免鼠标在图标边缘快速移动时动画闪烁\n}// 使用容器和热区同时监听事件，增加稳定性\ncontainer.on(\"mouseenter.animation\",startAnimation);container.on(\"mouseleave.animation\",endAnimation);hitArea.on(\"mouseenter.animation\",startAnimation);hitArea.on(\"mouseleave.animation\",endAnimation);// 防止事件传播导致问题\ncontainer.on(\"mousemove\",function(event){event.stopPropagation();if(!container._isAnimating&&container._hoverState){// 如果鼠标在图标上但动画停止了，重新启动\nstartAnimation();}});};return/*#__PURE__*/_jsx(\"div\",{ref:containerRef,className:\"calendar-container\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"calendar-loading\",children:\"\\u52A0\\u8F7D\\u4E2D...\"}):/*#__PURE__*/_jsx(\"svg\",{ref:svgRef,xmlns:\"http://www.w3.org/2000/svg\"})});};export default Calendar;","map":{"version":3,"names":["React","useRef","useEffect","useContext","useState","d3","AppContext","formatPace","jsx","_jsx","Calendar","svgRef","containerRef","runData","isLoading","dimensions","setDimensions","width","height","handleResize","current","rect","getBoundingClientRect","Math","max","window","addEventListener","removeEventListener","svg","select","selectAll","remove","attr","append","layout","leftMargin","topMargin","rightMargin","bottomMargin","usableWidth","monthWidth","daySpacing","months","i","rgb","darker","min","text","gridGroup","style","yPos","length","forEach","run","month","day","console","warn","x","y","isNaN","error","iconScale","runGroup","drawRunIcon","on","event","tooltip","empty","containerRect","tooltipContent","title","year","toString","padStart","distance","toFixed","pace","heartRate","runningNote","html","pageX","pageY","container","data","turns","spacing","baseRadius","spiralColor","gradientId","random","substring","defs","gradient","maxAngle","PI","angleStep","spiral","lineRadial","angle","d","radius","spiralGroup","points","range","staticSpiral","datum","animSpiral","paceCircle","spiralMaxRadius","circleRadius","distanceFactor","circleX","sqrt","circleY","paceColor","_isAnimating","_animationTimer","_hoverState","hitArea","startAnimation","clearTimeout","transition","duration","numSteps","currentStep","animateSpiral","interrupt","currentAngle","currentPoints","setTimeout","endAnimation","stopPropagation","ref","className","children","xmlns"],"sources":["/Users/wyl/Documents/GitHub/running-tracker-react/src/components/Calendar.js"],"sourcesContent":["import React, { useRef, useEffect, useContext, useState } from 'react';\nimport * as d3 from 'd3';\nimport { AppContext } from '../context/AppContext';\nimport './Calendar.css';\n\n// 导入格式化工具\nimport { formatPace } from '../utils/formatters';\n\nconst Calendar = () => {\n  const svgRef = useRef(null);\n  const containerRef = useRef(null);\n  const { runData, isLoading } = useContext(AppContext);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  \n  // 添加窗口大小变化监听\n  useEffect(() => {\n    const handleResize = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setDimensions({\n          width: rect.width,\n          height: Math.max(rect.width * 0.9, 400) // 根据宽度调整高度，但保持最小高度\n        });\n      }\n    };\n    \n    // 初始调用一次获取当前尺寸\n    handleResize();\n    \n    // 监听窗口大小变化\n    window.addEventListener('resize', handleResize);\n    \n    // 清除监听器\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  \n  // 更新SVG视图\n  useEffect(() => {\n    if (isLoading || !dimensions.width || !svgRef.current || !containerRef.current) return;\n    \n    const svg = d3.select(svgRef.current);\n    svg.selectAll(\"*\").remove();\n    \n    const { width, height } = dimensions;\n    \n    // 设置SVG尺寸\n    svg.attr(\"width\", width)\n       .attr(\"height\", height)\n       .attr(\"viewBox\", `0 0 ${width} ${height}`)\n       .attr(\"preserveAspectRatio\", \"xMidYMid meet\");\n    \n    // 背景\n    svg.append(\"rect\")\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .attr(\"fill\", \"#FDFAF6\")\n      .attr(\"rx\", 10);\n    \n    // 布局参数 - 使用相对尺寸而非固定尺寸\n    const layout = {\n      leftMargin: width * 0.08,\n      topMargin: 65,\n      rightMargin: width * 0.08,\n      bottomMargin: 30\n    };\n    \n    const usableWidth = width - layout.leftMargin - layout.rightMargin;\n    const monthWidth = usableWidth / 12;\n    // 更改计算方式以确保足够空间\n    const daySpacing = (height - layout.topMargin - layout.bottomMargin) / 32;\n    \n    // 月份标签\n    const months = [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"];\n    for (let i = 0; i < 12; i++) {\n      // 月份背景\n      svg.append(\"rect\")\n        .attr(\"x\", layout.leftMargin + i * monthWidth + 2)\n        .attr(\"y\", 8)\n        .attr(\"width\", monthWidth - 4)\n        .attr(\"height\", 30)\n        .attr(\"fill\", d3.rgb(\"#FDFAF6\").darker(0.05))\n        .attr(\"opacity\", 0.2)\n        .attr(\"rx\", 15);\n        \n      // 月份文字 - 响应式字体大小\n      svg.append(\"text\")\n        .attr(\"x\", layout.leftMargin + i * monthWidth + monthWidth / 2)\n        .attr(\"y\", 28)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n        .attr(\"font-weight\", \"bold\")\n        .attr(\"fill\", \"#896B54\")\n        .text(months[i]);\n    }\n    \n    // 网格线\n    const gridGroup = svg.append(\"g\").attr(\"class\", \"grid\");\n    \n    // 垂直网格线（月份分隔线）\n    for (let i = 0; i <= 12; i++) {\n      gridGroup.append(\"line\")\n        .attr(\"x1\", layout.leftMargin + i * monthWidth)\n        .attr(\"y1\", layout.topMargin)\n        .attr(\"x2\", layout.leftMargin + i * monthWidth)\n        .attr(\"y2\", height - layout.bottomMargin)\n        .style(\"stroke\", i % 3 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.05)\")\n        .style(\"stroke-width\", i % 3 === 0 ? 1.5 : 0.5);\n    }\n    \n    // 水平网格线和日期标签\n    for (let i = 0; i <= 31; i++) {\n      const yPos = layout.topMargin + i * daySpacing;\n      \n      gridGroup.append(\"line\")\n        .attr(\"x1\", layout.leftMargin - 5)\n        .attr(\"y1\", yPos)\n        .attr(\"x2\", width - layout.rightMargin)\n        .attr(\"y2\", yPos)\n        .style(\"stroke\", i % 5 === 0 ? \"rgba(0,0,0,0.1)\" : \"rgba(0,0,0,0.03)\")\n        .style(\"stroke-width\", i % 5 === 0 ? 1.5 : 0.5);\n      \n      if (i > 0 && i % 5 === 0) {\n        gridGroup.append(\"text\")\n          .attr(\"x\", layout.leftMargin - 20)\n          .attr(\"y\", yPos + 5)\n          .attr(\"text-anchor\", \"end\")\n          .attr(\"font-size\", Math.min(18, Math.max(12, width / 50))) // 响应式字体大小\n          .attr(\"fill\", \"#896B54\")\n          .text(i);\n      }\n    }\n    \n    // 绘制跑步数据点\n    if (runData && runData.length > 0) {\n      runData.forEach(run => {\n        if (typeof run.month !== 'number' || typeof run.day !== 'number') {\n          console.warn(\"跳过无效数据点:\", run);\n          return;\n        }\n        \n        // 确保月份和日期在有效范围内\n        if (run.month < 0 || run.month >= 12 || run.day <= 0 || run.day > 31) {\n          console.warn(\"数据点超出有效范围:\", run);\n          return;\n        }\n        \n        const x = layout.leftMargin + run.month * monthWidth + monthWidth / 2;\n        const y = layout.topMargin + run.day * daySpacing;\n        \n        // 检查计算的坐标是否有效\n        if (isNaN(x) || isNaN(y)) {\n          console.error(\"坐标计算错误:\", { run, x, y });\n          return;\n        }\n        \n        // 计算图标缩放比例 - 根据容器宽度自适应\n        const iconScale = Math.min(1.2, Math.max(0.8, width / 1000));\n        \n        const runGroup = svg.append(\"g\")\n          .attr(\"class\", \"run-icon\")\n          .attr(\"transform\", `translate(${x}, ${y}) scale(${iconScale})`)\n          .attr(\"cursor\", \"pointer\");\n        \n        // 绘制跑步图标\n        drawRunIcon(runGroup, run);\n        \n        // 添加事件处理\n        runGroup.on(\"mouseover\", function(event) {\n          // 显示提示框\n          const tooltip = d3.select(\".tooltip\");\n          if (tooltip.empty()) {\n            d3.select(\"body\").append(\"div\")\n              .attr(\"class\", \"tooltip\")\n              .style(\"position\", \"absolute\")\n              .style(\"visibility\", \"hidden\")\n              .style(\"background\", \"white\")\n              .style(\"padding\", \"15px\")\n              .style(\"border-radius\", \"8px\")\n              .style(\"box-shadow\", \"0 4px 20px rgba(0,0,0,0.08)\")\n              .style(\"z-index\", \"999\")\n              .style(\"max-width\", \"280px\");\n          }\n          \n          // 位置和内容\n          const containerRect = containerRef.current.getBoundingClientRect();\n          const tooltipContent = `\n            <div style=\"font-weight:600; color:#432818; font-size:14px; margin-bottom:8px;\">\n              ${run.title || `${run.year}-${(run.month+1).toString().padStart(2,'0')}-${run.day.toString().padStart(2,'0')}`}\n            </div>\n            <div>距离: ${run.distance.toFixed(1)} km</div>\n            <div>配速: ${formatPace(run.pace)}/km</div>\n            ${run.heartRate ? `<div>心率: ${run.heartRate} BPM</div>` : ''}\n            ${run.runningNote ? `<div style=\"margin-top:6px; font-style:italic;\">${run.runningNote}</div>` : ''}\n          `;\n          \n          d3.select(\".tooltip\")\n            .html(tooltipContent)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 15}px`)\n            .style(\"visibility\", \"visible\");\n        })\n        .on(\"mouseout\", function() {\n          d3.select(\".tooltip\").style(\"visibility\", \"hidden\");\n        });\n      });\n    }\n  }, [runData, isLoading, dimensions]);\n  \n  // 绘制跑步图标函数\n  const drawRunIcon = (container, data) => {\n    // 螺旋线参数\n    const turns = 2 + Math.min(3, data.distance / 5);\n    const spacing = 3.5;\n    const baseRadius = 3.5;\n    \n    // 颜色选择\n    let spiralColor;\n    if (data.distance >= 10) spiralColor = \"#FF9966\"; // 长距离\n    else if (data.distance > 5) spiralColor = \"#FFD700\"; // 中距离\n    else spiralColor = \"#87CEEB\"; // 短距离\n    \n    // 创建渐变\n    const gradientId = `spiral-gradient-${Math.random().toString(36).substring(2, 11)}`;\n    const defs = container.append(\"defs\");\n    const gradient = defs.append(\"radialGradient\")\n      .attr(\"id\", gradientId)\n      .attr(\"cx\", \"0\")\n      .attr(\"cy\", \"0\")\n      .attr(\"r\", \"100%\")\n      .attr(\"fx\", \"0\")\n      .attr(\"fy\", \"0\")\n      .attr(\"gradientUnits\", \"userSpaceOnUse\");\n    \n    gradient.append(\"stop\")\n      .attr(\"offset\", \"0%\")\n      .attr(\"stop-color\", spiralColor)\n      .attr(\"stop-opacity\", 0.9);\n    \n    gradient.append(\"stop\")\n      .attr(\"offset\", \"100%\")\n      .attr(\"stop-color\", spiralColor)\n      .attr(\"stop-opacity\", 0.5);\n    \n    // 最大角度\n    const maxAngle = turns * 2 * Math.PI;\n    const angleStep = 0.1;\n    \n    // 创建螺旋线生成器\n    const spiral = d3.lineRadial()\n      .angle(d => d)\n      .radius(d => baseRadius + spacing * d / (2 * Math.PI));\n    \n    // 创建一个包含所有螺旋线元素的组\n    const spiralGroup = container.append(\"g\")\n      .attr(\"class\", \"spiral-group\");\n      \n    // 静态完整螺旋线\n    const points = d3.range(0, maxAngle, angleStep);\n    const staticSpiral = spiralGroup.append(\"path\")\n      .datum(points)\n      .attr(\"d\", spiral)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", `url(#${gradientId})`)\n      .attr(\"stroke-width\", 2.5)\n      .attr(\"stroke-linecap\", \"round\");\n      \n    // 动画用路径（初始不可见）\n    const animSpiral = spiralGroup.append(\"path\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", `url(#${gradientId})`)\n      .attr(\"stroke-width\", 2.5)\n      .attr(\"stroke-linecap\", \"round\")\n      .style(\"opacity\", 0);\n    \n    // 配速指示器\n    let paceCircle = null;\n    if (data.pace > 0) {\n      const spiralMaxRadius = baseRadius + spacing * maxAngle / (2 * Math.PI);\n      const circleRadius = 3.6;\n      const distanceFactor = 1.3;\n      const circleX = spiralMaxRadius * distanceFactor * (1/Math.sqrt(2));\n      const circleY = -spiralMaxRadius * distanceFactor * (1/Math.sqrt(2));\n      \n      // 根据配速选择颜色\n      let paceColor;\n      if (data.pace < 5.5) paceColor = \"#FF4500\"; // 快配速\n      else if (data.pace < 7) paceColor = \"#FFD700\"; // 中配速\n      else paceColor = \"#7FD8BE\"; // 慢配速\n      \n      // 添加配速指示圆点\n      paceCircle = container.append(\"circle\")\n        .attr(\"cx\", circleX)\n        .attr(\"cy\", circleY)\n        .attr(\"r\", circleRadius)\n        .attr(\"fill\", paceColor)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"stroke-width\", 1)\n        .style(\"opacity\", 0.9);\n    }\n    \n    // 动画状态变量 - 设为容器的属性以增加可访问性\n    container._isAnimating = false;\n    container._animationTimer = null;\n    container._hoverState = false; // 新增：跟踪鼠标是否在图标上\n    \n    // 创建透明的较大热区，增加鼠标事件的稳定性\n    const hitArea = container.append(\"circle\")\n      .attr(\"cx\", 0)\n      .attr(\"cy\", 0)\n      .attr(\"r\", 15) // 较大的半径提供更好的交互区域\n      .attr(\"fill\", \"transparent\")\n      .style(\"pointer-events\", \"all\"); // 确保能捕获事件\n    \n    // 动画函数 - 提取出来以便复用\n    function startAnimation() {\n      // 如果已经在动画中，不再重复启动\n      if (container._isAnimating) return;\n      container._isAnimating = true;\n      container._hoverState = true;\n      \n      // 清除任何存在的定时器\n      if (container._animationTimer) {\n        clearTimeout(container._animationTimer);\n        container._animationTimer = null;\n      }\n      \n      // 隐藏静态螺旋线\n      staticSpiral.transition().duration(100).style(\"opacity\", 0);\n      \n      // 暂时隐藏配速指示器\n      if (paceCircle) paceCircle.transition().duration(100).style(\"opacity\", 0);\n      \n      // 创建动态增长的螺旋线动画\n      const numSteps = 20; // 动画步数\n      let currentStep = 0;\n      \n      function animateSpiral() {\n        if (!container._hoverState || currentStep >= numSteps) {\n          // 动画完成或鼠标已离开，显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n          container._animationTimer = null;\n          return;\n        }\n        \n        // 增加当前步骤\n        currentStep++;\n        \n        // 计算此步骤的螺旋线角度\n        const currentAngle = (currentStep / numSteps) * maxAngle;\n        const currentPoints = d3.range(0, currentAngle, angleStep);\n        \n        // 更新动画螺旋线\n        animSpiral\n          .datum(currentPoints)\n          .attr(\"d\", spiral)\n          .style(\"opacity\", 1);\n        \n        // 设置下一帧\n        container._animationTimer = setTimeout(animateSpiral, 20);\n      }\n      \n      // 启动动画\n      animateSpiral();\n    }\n    \n    // 结束动画函数\n    function endAnimation() {\n      container._hoverState = false; // 标记鼠标已离开\n      \n      // 添加延迟以避免鼠标短暂离开又返回时动画重启\n      setTimeout(() => {\n        if (!container._hoverState) {\n          // 如果鼠标真的离开了(没有重新进入)\n          if (container._animationTimer) {\n            clearTimeout(container._animationTimer);\n            container._animationTimer = null;\n          }\n          \n          // 立即显示静态螺旋线\n          staticSpiral.interrupt().style(\"opacity\", 1);\n          animSpiral.interrupt().style(\"opacity\", 0);\n          if (paceCircle) paceCircle.interrupt().style(\"opacity\", 0.9);\n          container._isAnimating = false;\n        }\n      }, 50); // 短暂延迟，避免鼠标在图标边缘快速移动时动画闪烁\n    }\n    \n    // 使用容器和热区同时监听事件，增加稳定性\n    container.on(\"mouseenter.animation\", startAnimation);\n    container.on(\"mouseleave.animation\", endAnimation);\n    hitArea.on(\"mouseenter.animation\", startAnimation);\n    hitArea.on(\"mouseleave.animation\", endAnimation);\n    \n    // 防止事件传播导致问题\n    container.on(\"mousemove\", function(event) {\n      event.stopPropagation();\n      if (!container._isAnimating && container._hoverState) {\n        // 如果鼠标在图标上但动画停止了，重新启动\n        startAnimation();\n      }\n    });\n  };\n\n  return (\n    <div ref={containerRef} className=\"calendar-container\">\n      {isLoading ? (\n        <div className=\"calendar-loading\">加载中...</div>\n      ) : (\n        <svg ref={svgRef} xmlns=\"http://www.w3.org/2000/svg\"></svg>\n      )}\n    </div>\n  );\n};\n\nexport default Calendar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}