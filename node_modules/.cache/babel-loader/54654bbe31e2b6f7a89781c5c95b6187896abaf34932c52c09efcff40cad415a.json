{"ast":null,"code":"import React,{useContext,useState}from'react';import{AppContext}from'../context/AppContext';import'./StatsPanel.css';import{formatPace}from'../utils/formatters';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StatsPanel=()=>{const{runData,totalDistance,runCount,isLoading}=useContext(AppContext);const[isCollapsed,setIsCollapsed]=useState(false);// 计算月度统计数据\nconst calculateMonthlyStats=()=>{const monthlyStats=[];// 初始化每个月的统计数据\nfor(let i=0;i<12;i++){monthlyStats[i]={days:0,distance:0,avgPace:0,totalPace:0,avgHeartRate:0,totalHeartRate:0,paceCount:0};}// 累计各月数据\nrunData.forEach(run=>{const month=run.month;if(month>=0&&month<12){monthlyStats[month].days+=1;monthlyStats[month].distance+=run.distance;if(run.pace>0){monthlyStats[month].totalPace+=run.pace;monthlyStats[month].paceCount+=1;}if(run.heartRate>0){monthlyStats[month].totalHeartRate+=run.heartRate;}}});// 计算平均值\nfor(let i=0;i<12;i++){if(monthlyStats[i].days>0){if(monthlyStats[i].paceCount>0){monthlyStats[i].avgPace=monthlyStats[i].totalPace/monthlyStats[i].paceCount;}if(monthlyStats[i].totalHeartRate>0){monthlyStats[i].avgHeartRate=Math.round(monthlyStats[i].totalHeartRate/monthlyStats[i].days);}}}return monthlyStats;};// 计算合计数据\nconst calculateTotalStats=monthlyStats=>{const totalStats={days:0,distance:0,totalPace:0,paceCount:0,avgPace:0};monthlyStats.forEach(stat=>{totalStats.days+=stat.days;totalStats.distance+=stat.distance;if(stat.avgPace>0&&stat.paceCount>0){totalStats.totalPace+=stat.totalPace;totalStats.paceCount+=stat.paceCount;}});if(totalStats.paceCount>0){totalStats.avgPace=totalStats.totalPace/totalStats.paceCount;}return totalStats;};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"stats-panel-loading\",children:\"\\u52A0\\u8F7D\\u4E2D...\"});}const monthlyStats=calculateMonthlyStats();const totalStats=calculateTotalStats(monthlyStats);const months=[\"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\"];return/*#__PURE__*/_jsxs(\"div\",{className:\"stats-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stats-header\",onClick:()=>setIsCollapsed(!isCollapsed),children:[/*#__PURE__*/_jsx(\"h3\",{className:\"stats-title\",children:\"\\u6708\\u5EA6\\u7EDF\\u8BA1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toggle-icon\",children:isCollapsed?'▶':'▼'})]}),/*#__PURE__*/_jsx(\"div\",{className:`stats-content ${isCollapsed?'collapsed':''}`,children:/*#__PURE__*/_jsxs(\"table\",{className:\"stats-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"metrics-label\"}),months.map((month,idx)=>/*#__PURE__*/_jsx(\"th\",{className:\"month-label\",children:month},idx)),/*#__PURE__*/_jsx(\"th\",{className:\"total-label\",children:\"\\u5168\\u5E74\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"metrics-label\",children:\"\\u5929\\u6570\"}),monthlyStats.map((stat,idx)=>/*#__PURE__*/_jsx(\"td\",{className:`stat-value ${stat.days>0?'has-data':''}`,children:stat.days>0?stat.days:'-'},idx)),/*#__PURE__*/_jsx(\"td\",{className:\"total-value\",children:totalStats.days})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"metrics-label\",children:\"\\u8DDD\\u79BB-km\"}),monthlyStats.map((stat,idx)=>/*#__PURE__*/_jsx(\"td\",{className:`stat-value ${stat.distance>0?'has-data':''}`,children:stat.distance>0?stat.distance.toFixed(1):'-'},idx)),/*#__PURE__*/_jsx(\"td\",{className:\"total-value\",children:totalStats.distance.toFixed(1)})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"metrics-label\",children:\"\\u914D\\u901F/km\"}),monthlyStats.map((stat,idx)=>/*#__PURE__*/_jsx(\"td\",{className:`stat-value ${stat.avgPace>0?'has-data':''}`,children:stat.avgPace>0?formatPace(stat.avgPace):'-'},idx)),/*#__PURE__*/_jsx(\"td\",{className:\"total-value\",children:totalStats.avgPace>0?formatPace(totalStats.avgPace):'-'})]})]})]})})]});};export default StatsPanel;","map":{"version":3,"names":["React","useContext","useState","AppContext","formatPace","jsx","_jsx","jsxs","_jsxs","StatsPanel","runData","totalDistance","runCount","isLoading","isCollapsed","setIsCollapsed","calculateMonthlyStats","monthlyStats","i","days","distance","avgPace","totalPace","avgHeartRate","totalHeartRate","paceCount","forEach","run","month","pace","heartRate","Math","round","calculateTotalStats","totalStats","stat","className","children","months","onClick","map","idx","toFixed"],"sources":["/Users/wyl/Documents/GitHub/running-tracker-react/src/components/StatsPanel.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\nimport { AppContext } from '../context/AppContext';\nimport './StatsPanel.css';\nimport { formatPace } from '../utils/formatters';\n\nconst StatsPanel = () => {\n  const { runData, totalDistance, runCount, isLoading } = useContext(AppContext);\n  const [isCollapsed, setIsCollapsed] = useState(false);\n  \n  // 计算月度统计数据\n  const calculateMonthlyStats = () => {\n    const monthlyStats = [];\n    \n    // 初始化每个月的统计数据\n    for (let i = 0; i < 12; i++) {\n      monthlyStats[i] = {\n        days: 0,\n        distance: 0,\n        avgPace: 0,\n        totalPace: 0,\n        avgHeartRate: 0,\n        totalHeartRate: 0,\n        paceCount: 0\n      };\n    }\n    \n    // 累计各月数据\n    runData.forEach(run => {\n      const month = run.month;\n      if (month >= 0 && month < 12) {\n        monthlyStats[month].days += 1;\n        monthlyStats[month].distance += run.distance;\n        \n        if (run.pace > 0) {\n          monthlyStats[month].totalPace += run.pace;\n          monthlyStats[month].paceCount += 1;\n        }\n        \n        if (run.heartRate > 0) {\n          monthlyStats[month].totalHeartRate += run.heartRate;\n        }\n      }\n    });\n    \n    // 计算平均值\n    for (let i = 0; i < 12; i++) {\n      if (monthlyStats[i].days > 0) {\n        if (monthlyStats[i].paceCount > 0) {\n          monthlyStats[i].avgPace = monthlyStats[i].totalPace / monthlyStats[i].paceCount;\n        }\n        \n        if (monthlyStats[i].totalHeartRate > 0) {\n          monthlyStats[i].avgHeartRate = Math.round(monthlyStats[i].totalHeartRate / monthlyStats[i].days);\n        }\n      }\n    }\n    \n    return monthlyStats;\n  };\n\n  // 计算合计数据\n  const calculateTotalStats = (monthlyStats) => {\n    const totalStats = {\n      days: 0,\n      distance: 0,\n      totalPace: 0,\n      paceCount: 0,\n      avgPace: 0\n    };\n    \n    monthlyStats.forEach(stat => {\n      totalStats.days += stat.days;\n      totalStats.distance += stat.distance;\n      if (stat.avgPace > 0 && stat.paceCount > 0) {\n        totalStats.totalPace += stat.totalPace;\n        totalStats.paceCount += stat.paceCount;\n      }\n    });\n    \n    if (totalStats.paceCount > 0) {\n      totalStats.avgPace = totalStats.totalPace / totalStats.paceCount;\n    }\n    \n    return totalStats;\n  };\n  \n  if (isLoading) {\n    return <div className=\"stats-panel-loading\">加载中...</div>;\n  }\n  \n  const monthlyStats = calculateMonthlyStats();\n  const totalStats = calculateTotalStats(monthlyStats);\n  const months = [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"];\n  \n  return (\n    <div className=\"stats-panel\">\n      <div className=\"stats-header\" onClick={() => setIsCollapsed(!isCollapsed)}>\n        <h3 className=\"stats-title\">月度统计</h3>\n        <div className=\"toggle-icon\">{isCollapsed ? '▶' : '▼'}</div>\n      </div>\n      \n      <div className={`stats-content ${isCollapsed ? 'collapsed' : ''}`}>\n        <table className=\"stats-table\">\n          <thead>\n            <tr>\n              <th className=\"metrics-label\"></th>\n              {months.map((month, idx) => (\n                <th key={idx} className=\"month-label\">{month}</th>\n              ))}\n              <th className=\"total-label\">全年</th>\n            </tr>\n          </thead>\n          <tbody>\n            {/* 天数行 */}\n            <tr>\n              <td className=\"metrics-label\">天数</td>\n              {monthlyStats.map((stat, idx) => (\n                <td key={idx} className={`stat-value ${stat.days > 0 ? 'has-data' : ''}`}>\n                  {stat.days > 0 ? stat.days : '-'}\n                </td>\n              ))}\n              <td className=\"total-value\">{totalStats.days}</td>\n            </tr>\n            \n            {/* 距离行 */}\n            <tr>\n              <td className=\"metrics-label\">距离-km</td>\n              {monthlyStats.map((stat, idx) => (\n                <td key={idx} className={`stat-value ${stat.distance > 0 ? 'has-data' : ''}`}>\n                  {stat.distance > 0 ? stat.distance.toFixed(1) : '-'}\n                </td>\n              ))}\n              <td className=\"total-value\">{totalStats.distance.toFixed(1)}</td>\n            </tr>\n            \n            {/* 配速行 */}\n            <tr>\n              <td className=\"metrics-label\">配速/km</td>\n              {monthlyStats.map((stat, idx) => (\n                <td key={idx} className={`stat-value ${stat.avgPace > 0 ? 'has-data' : ''}`}>\n                  {stat.avgPace > 0 ? formatPace(stat.avgPace) : '-'}\n                </td>\n              ))}\n              <td className=\"total-value\">\n                {totalStats.avgPace > 0 ? formatPace(totalStats.avgPace) : '-'}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default StatsPanel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}